# Bet-maker

[![black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/ambv/black)
[![ruff](https://img.shields.io/badge/linting-ruff-261230)](https://github.com/astral-sh/ruff)
[![pre-commit](https://img.shields.io/badge/pre--commit-enabled-brightgreen?logo=pre-commit)](https://github.com/pre-commit/pre-commit)

## Общая информация

Система, принимающая пользовательские ставки на спортивные события.

## Локальный запуск

1. Склонировать репозиторий
2. Перейти в папку с проектом
3. Выполнить команду `cp .env.example .env` (поменять конфигурацию при необходимости)
4. Выполнить команду `docker-compose up`

- Сервис bet-maker будет доступен по адресу <http://127.0.0.1:8080/>

## API bet-maker

### POST /bets

Совершает ставку на событие.
В теле запроса необходимо передать JSON-объект, содержащий:

- идентификатор события — число,
- сумму ставки — строго положительное число с двумя знаками после запятой.

В ответе возвращается уникальный идентификатор ставки.

#### Пример запроса:

```json
{
  "event_id": 1,
  "amount": 10.50
}
```

#### Пример ответа (200 - OK)

```json
{
  "bet_id": 1,
  "message": "Bet created successfully"
}
```

### GET /bets

Возвращает историю всех сделанных ставок — массив JSON-объектов, содержащих информацию о ставках
Статус ставки может быть одним из следующих:

- 1 - ещё не сыграла (соответствующее событие ещё не завершилось),
- 2 - выиграла (событие завершилось выигрышем первой команды),
- 3 - проиграла (событие завершилось проигрышем первой команды или ничьей).

#### Пример ответа (200 - OK)

```json
[
  {
    "bet_id": 1,
    "event_id": 1,
    "state": 1,
    "amount": "10.50"
  }
]
```

### PUT /events/{event_id}

Сообщает о том, что в событии с указанным event_id произошли изменения.
В теле запроса необходимо передать JSON-объект, содержащий единственное поле — новый статус события. Поле может принимать одно из следующих строковых значений: *WIN*, *LOSE*.

Обработчик запроса соответствующим образом обновит статусы всех совершённых на данное событие ставок.

#### Пример запроса:

Параметры пути:

- `event_id` (обязательный): Уникальный идентификатор события.

Тело запроса:

```json
{
  "state": "WIN"
}
```

#### Пример ответа (200 - OK):

```json
{
  "event_id": 1,
  "message": "Event updated successfully"
}
```
